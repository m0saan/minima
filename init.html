<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="The init module in the minima (mi) library provides a suite of tensor initialization functions to create and initialize tensors in various ways. Each function in this module represents a different strategy for initializing the values of a tensor, such as uniform or normal random values, constant values, or specialized initializations like Xavier or Kaiming methods.">

<title>minima - init</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="minima - init">
<meta property="og:description" content="The init module in the minima (mi) library provides a suite of tensor initialization functions to create and initialize tensors in various ways. Each function in this module represents a different strategy for initializing the values of a tensor, such as uniform or normal random values, constant values, or specialized initializations like Xavier or Kaiming methods.">
<meta property="og:image" content="https://m0saan.github.io/minima/../assets/10.xav-init-normal.svg">
<meta property="og:site-name" content="minima">
<meta name="twitter:title" content="minima - init">
<meta name="twitter:description" content="The init module in the minima (mi) library provides a suite of tensor initialization functions to create and initialize tensors in various ways. Each function in this module represents a different strategy for initializing the values of a tensor, such as uniform or normal random values, constant values, or specialized initializations like Xavier or Kaiming methods.">
<meta name="twitter:image" content="https://m0saan.github.io/minima/../assets/10.xav-init-normal.svg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">minima</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./init.html">init</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to minima</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./autograd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">autograd</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./operators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">operators</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./init.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">init</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">nn</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">optim</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ndarray.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ndarray</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ndarray_backend_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ndarray_backend_numpy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">utility</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#rand" id="toc-rand" class="nav-link active" data-scroll-target="#rand">rand</a></li>
  <li><a href="#randn" id="toc-randn" class="nav-link" data-scroll-target="#randn">randn</a></li>
  <li><a href="#constant" id="toc-constant" class="nav-link" data-scroll-target="#constant">constant</a></li>
  <li><a href="#ones" id="toc-ones" class="nav-link" data-scroll-target="#ones">ones</a></li>
  <li><a href="#zeros" id="toc-zeros" class="nav-link" data-scroll-target="#zeros">zeros</a></li>
  <li><a href="#randb" id="toc-randb" class="nav-link" data-scroll-target="#randb">randb</a></li>
  <li><a href="#one_hot" id="toc-one_hot" class="nav-link" data-scroll-target="#one_hot">one_hot</a></li>
  <li><a href="#glorotxavier-initialization" id="toc-glorotxavier-initialization" class="nav-link" data-scroll-target="#glorotxavier-initialization">Glorot/Xavier Initialization</a></li>
  <li><a href="#xavier_normal" id="toc-xavier_normal" class="nav-link" data-scroll-target="#xavier_normal">xavier_normal</a></li>
  <li><a href="#xavier_uniform" id="toc-xavier_uniform" class="nav-link" data-scroll-target="#xavier_uniform">xavier_uniform</a></li>
  <li><a href="#he-initialization" id="toc-he-initialization" class="nav-link" data-scroll-target="#he-initialization">He Initialization</a></li>
  <li><a href="#kaiming_normal" id="toc-kaiming_normal" class="nav-link" data-scroll-target="#kaiming_normal">kaiming_normal</a></li>
  <li><a href="#kaiming_uniform" id="toc-kaiming_uniform" class="nav-link" data-scroll-target="#kaiming_uniform">kaiming_uniform</a></li>
  <li><a href="#lsuv-initialization" id="toc-lsuv-initialization" class="nav-link" data-scroll-target="#lsuv-initialization">LSUV Initialization</a></li>
  <li><a href="#export" id="toc-export" class="nav-link" data-scroll-target="#export">Export</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/m0saan/minima/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">init</h1>
</div>

<div>
  <div class="description">
    The <code>init</code> module in the <code>minima</code> (mi) library provides a suite of tensor initialization functions to create and initialize tensors in various ways. Each function in this module represents a different strategy for initializing the values of a tensor, such as uniform or normal random values, constant values, or specialized initializations like Xavier or Kaiming methods.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<ol type="1">
<li><strong><a href="https://m0saan.github.io/minima/init.html#rand"><code>rand</code></a></strong>: This function generates a tensor filled with random numbers drawn from a uniform distribution between <code>low</code> and <code>high</code> (defaulting to 0 and 1). It does this by creating an array of random values on the specified device (defaulting to CPU), then scales and shifts these values to the correct range. The result is wrapped in a <code>mi.Tensor</code> object, which supports automatic differentiation if <code>requires_grad</code> is True.</li>
</ol>
<hr>
<p><a href="https://github.com/m0saan/minima/blob/main/minima/init.py#L13" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="rand" class="level3">
<h3 class="anchored" data-anchor-id="rand">rand</h3>
<blockquote class="blockquote">
<pre><code> rand (*shape, low=0.0, high=1.0, device=None, dtype='float32',
       requires_grad=False)</code></pre>
</blockquote>
<p>Generates a tensor with random numbers uniformly distributed between <code>low</code> and <code>high</code>.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>shape</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>low</td>
<td>float</td>
<td>0.0</td>
<td></td>
</tr>
<tr class="odd">
<td>high</td>
<td>float</td>
<td>1.0</td>
<td></td>
</tr>
<tr class="even">
<td>device</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="odd">
<td>dtype</td>
<td>str</td>
<td>float32</td>
<td></td>
</tr>
<tr class="even">
<td>requires_grad</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>mi.Tensor</strong></td>
<td></td>
<td><strong>A tensor of shape <code>shape</code>, filled with random numbers from the uniform distribution between <code>low</code> and <code>high</code>.</strong></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>rand(<span class="dv">10</span>,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>minima.Tensor(
[[0.423019 0.831303 0.593536 0.464066 0.622164]
 [0.519762 0.698    0.364592 0.593321 0.299263]
 [0.330883 0.566039 0.327606 0.069224 0.077561]
 [0.591434 0.092411 0.049555 0.729441 0.001867]
 [0.60242  0.36611  0.162999 0.602054 0.684817]
 [0.545608 0.415636 0.746867 0.923219 0.67769 ]
 [0.809501 0.496377 0.527514 0.333276 0.479529]
 [0.080732 0.63581  0.950788 0.387371 0.570476]
 [0.677467 0.620451 0.702335 0.071747 0.067357]
 [0.66082  0.372642 0.226082 0.687941 0.761832]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> rand(<span class="dv">10</span>,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>t.dtype, t.device, t.requires_grad</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(dtype('float32'), minima.cpu(), False)</code></pre>
</div>
</div>
<ol start="2" type="1">
<li><strong><a href="https://m0saan.github.io/minima/init.html#randn"><code>randn</code></a></strong>: Similar to <a href="https://m0saan.github.io/minima/init.html#rand"><code>rand</code></a>, but generates numbers from a normal distribution with the specified mean and standard deviation (defaulting to 0 and 1). This is done by creating an array of normally-distributed random values, then scaling and shifting them to match the requested parameters.</li>
</ol>
<hr>
<p><a href="https://github.com/m0saan/minima/blob/main/minima/init.py#L45" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="randn" class="level3">
<h3 class="anchored" data-anchor-id="randn">randn</h3>
<blockquote class="blockquote">
<pre><code> randn (*shape, mean=0.0, std=1.0, device=None, dtype='float32',
        requires_grad=False)</code></pre>
</blockquote>
<p>Generates a tensor with random numbers normally distributed with specified mean and standard deviation.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>shape</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>mean</td>
<td>float</td>
<td>0.0</td>
<td></td>
</tr>
<tr class="odd">
<td>std</td>
<td>float</td>
<td>1.0</td>
<td></td>
</tr>
<tr class="even">
<td>device</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="odd">
<td>dtype</td>
<td>str</td>
<td>float32</td>
<td></td>
</tr>
<tr class="even">
<td>requires_grad</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>mi.Tensor</strong></td>
<td></td>
<td><strong>A tensor of shape <code>shape</code>, filled with random numbers from the normal distribution with the specified mean and standard deviation.</strong></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> randn(<span class="dv">5</span>,<span class="dv">5</span>, requires_grad<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>minima.Tensor(
[[ 0.934699 -1.883731  1.56695   0.929079  0.73024 ]
 [ 2.066303  0.109121  1.161415 -1.184726 -1.753147]
 [ 0.339952 -1.125624 -0.740886 -0.808628  0.024874]
 [-0.307566  1.072183  0.013086  0.407447 -0.705648]
 [-0.956348 -0.291481 -0.1       0.70653   0.500862]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>t.shape, t.dtype, t.device, t.requires_grad</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>((5, 5), dtype('float32'), minima.cpu(), True)</code></pre>
</div>
</div>
<ol start="3" type="1">
<li><strong><a href="https://m0saan.github.io/minima/init.html#constant"><code>constant</code></a></strong>: This function creates a tensor filled with a constant value <code>c</code> (defaulting to 1). It does this by creating an array of ones on the specified device and then scaling these ones by the constant value.</li>
</ol>
<hr>
<p><a href="https://github.com/m0saan/minima/blob/main/minima/init.py#L75" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="constant" class="level3">
<h3 class="anchored" data-anchor-id="constant">constant</h3>
<blockquote class="blockquote">
<pre><code> constant (*shape, c=1.0, device=None, dtype='float32',
           requires_grad=False)</code></pre>
</blockquote>
<p>Generates a tensor filled with a constant value.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>shape</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>c</td>
<td>float</td>
<td>1.0</td>
<td></td>
</tr>
<tr class="odd">
<td>device</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>dtype</td>
<td>str</td>
<td>float32</td>
<td></td>
</tr>
<tr class="odd">
<td>requires_grad</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>mi.Tensor</strong></td>
<td></td>
<td><strong>A tensor of shape <code>shape</code>, filled with the constant value <code>c</code>.</strong></td>
</tr>
</tbody>
</table>
<ol start="4" type="1">
<li><strong><a href="https://m0saan.github.io/minima/init.html#ones"><code>ones</code></a> and <a href="https://m0saan.github.io/minima/init.html#zeros"><code>zeros</code></a></strong>: These functions are simply shortcuts for creating tensors filled with ones or zeros, respectively. They’re implemented by calling the <a href="https://m0saan.github.io/minima/init.html#constant"><code>constant</code></a> function with <code>c</code> set to 1 or 0.</li>
</ol>
<hr>
<p><a href="https://github.com/m0saan/minima/blob/main/minima/init.py#L103" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="ones" class="level3">
<h3 class="anchored" data-anchor-id="ones">ones</h3>
<blockquote class="blockquote">
<pre><code> ones (*shape, device=None, dtype='float32', requires_grad=False)</code></pre>
</blockquote>
<p>Generates a tensor filled with ones.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>shape</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>device</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="odd">
<td>dtype</td>
<td>str</td>
<td>float32</td>
<td></td>
</tr>
<tr class="even">
<td>requires_grad</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>mi.Tensor</strong></td>
<td></td>
<td><strong>A tensor of shape <code>shape</code>, filled with ones.</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/m0saan/minima/blob/main/minima/init.py#L127" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="zeros" class="level3">
<h3 class="anchored" data-anchor-id="zeros">zeros</h3>
<blockquote class="blockquote">
<pre><code> zeros (*shape, device=None, dtype='float32', requires_grad=False)</code></pre>
</blockquote>
<p>Generates a tensor filled with zeros.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>shape</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>device</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="odd">
<td>dtype</td>
<td>str</td>
<td>float32</td>
<td></td>
</tr>
<tr class="even">
<td>requires_grad</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>mi.Tensor</strong></td>
<td></td>
<td><strong>A tensor of shape <code>shape</code>, filled with zeros.</strong></td>
</tr>
</tbody>
</table>
<ol start="5" type="1">
<li><strong><a href="https://m0saan.github.io/minima/init.html#randb"><code>randb</code></a></strong>: This function creates a binary tensor, with each element independently being True with probability <code>p</code> (defaulting to 0.5). This is done by generating uniformly-distributed random numbers and checking whether they’re less than or equal to <code>p</code>.</li>
</ol>
<hr>
<p><a href="https://github.com/m0saan/minima/blob/main/minima/init.py#L151" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="randb" class="level3">
<h3 class="anchored" data-anchor-id="randb">randb</h3>
<blockquote class="blockquote">
<pre><code> randb (*shape, p=0.5, device=None, dtype='bool', requires_grad=False)</code></pre>
</blockquote>
<p>Generates a binary tensor with random values of <code>True</code> or <code>False</code>.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>shape</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>p</td>
<td>float</td>
<td>0.5</td>
<td></td>
</tr>
<tr class="odd">
<td>device</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>dtype</td>
<td>str</td>
<td>bool</td>
<td></td>
</tr>
<tr class="odd">
<td>requires_grad</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>mi.Tensor</strong></td>
<td></td>
<td><strong>A binary tensor of shape <code>shape</code>, filled with random boolean values, where the probability of <code>True</code> is <code>p</code>.</strong></td>
</tr>
</tbody>
</table>
<ol start="6" type="1">
<li><strong><a href="https://m0saan.github.io/minima/init.html#one_hot"><code>one_hot</code></a></strong>: This function creates a one-hot encoding tensor. Given a size <code>n</code> and an index <code>i</code>, it creates a tensor of size <code>n</code> with a 1 at the <code>i</code>-th position and 0s elsewhere.</li>
</ol>
<hr>
<p><a href="https://github.com/m0saan/minima/blob/main/minima/init.py#L179" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="one_hot" class="level3">
<h3 class="anchored" data-anchor-id="one_hot">one_hot</h3>
<blockquote class="blockquote">
<pre><code> one_hot (n, i, device=None, dtype='float32', requires_grad=False)</code></pre>
</blockquote>
<p>Generates a one-hot encoding tensor.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n</td>
<td>int</td>
<td></td>
<td>The size of the one-hot vector.</td>
</tr>
<tr class="even">
<td>i</td>
<td>int</td>
<td></td>
<td>The index to be set to <code>1</code> in the one-hot vector.</td>
</tr>
<tr class="odd">
<td>device</td>
<td>NoneType</td>
<td>None</td>
<td>The device where the tensor will be allocated. Default is CPU.</td>
</tr>
<tr class="even">
<td>dtype</td>
<td>str</td>
<td>float32</td>
<td>The data type of the tensor. Default is ‘float32’.</td>
</tr>
<tr class="odd">
<td>requires_grad</td>
<td>bool</td>
<td>False</td>
<td>If True, the tensor is created with gradient tracking. Default is False.</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>mi.Tensor</strong></td>
<td></td>
<td><strong>A one-hot tensor of size <code>n</code>, with the <code>i</code>th element set to <code>1</code> and all others set to <code>0</code>.</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="glorotxavier-initialization" class="level3">
<h3 class="anchored" data-anchor-id="glorotxavier-initialization">Glorot/Xavier Initialization</h3>
<p>Xavier initialization, also known as Glorot initialization, is a technique for initializing the weights in artificial neural networks to improve the stability and speed of neural network training. In the paper Understanding the difficulty of training deep feedforward neural networks, researchers identified a value for the variance of the weights that works well to mitigate the problems we’ve discussed.</p>
<p>Here’s a high-level idea of how it works:</p>
<p>Neural networks are trained using a method called backpropagation, which involves iteratively adjusting the weights of the network based on the difference between the network’s current output and its desired output.</p>
<p>One challenge with this process is that the scale of the initial weights can have a large impact on the network’s learning dynamics. If the weights are too large or too small, the network might learn very slowly, or not at all. This is particularly an issue in deep networks where there are many layers of weights to learn.</p>
<p>Xavier initialization seeks to address this issue by scaling the initial weights in proportion to the number of inputs and outputs of the neuron. Specifically, in Xavier initialization, the weights are drawn from a distribution with zero a mean of 0 and a variance defined as:</p>
<p><span class="math display">\[
\text{var}(w)=\frac{2}{n_{in}+n_{out}}
\]</span></p>
<p>where <span class="math inline">\(n_{in}\)</span> is the number of inputs to the neuron and <span class="math inline">\(n_{out}\)</span> is the number of outputs. In order to induce the weights to acquire a standard deviation of <span class="math inline">\(\sqrt{\frac{2}{n_{in}+n_{out}}}\)</span>, consequently causing a variance of <span class="math inline">\(\frac{2}{n_{in}+n_{out}}\)</span>, the weights are initially produced randomly from a normal distribution with a mean of 0 and a standard deviation of 1.</p>
<p>Subsequently, every weight is multiplied by <span class="math inline">\(\sqrt{\frac{2}{n_{in}+n_{out}}}\)</span>, effectively shifting the standard deviation of the distribution to <span class="math inline">\(\sqrt{\frac{2}{n_{in}+n_{out}}}\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/10.xav-init-normal.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Xavier initialization from a normal distribution</figcaption>
</figure>
</div>
<hr>
<p><a href="https://github.com/m0saan/minima/blob/main/minima/init.py#L206" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="xavier_normal" class="level3">
<h3 class="anchored" data-anchor-id="xavier_normal">xavier_normal</h3>
<blockquote class="blockquote">
<pre><code> xavier_normal (fan_in, fan_out, gain=1.0, **kwargs)</code></pre>
</blockquote>
<p>Initializes a tensor using Xavier (Glorot) Normal initialization.</p>
<p>This initializer is designed to keep the scale of the gradients roughly the same in all layers. It samples weights from a normal distribution centered around 0 with standard deviation <code>gain * sqrt(2 / (fan_in + fan_out))</code></p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fan_in</td>
<td>int</td>
<td></td>
<td>The number of input units in the weight tensor.</td>
</tr>
<tr class="even">
<td>fan_out</td>
<td>int</td>
<td></td>
<td>The number of output units in the weight tensor.</td>
</tr>
<tr class="odd">
<td>gain</td>
<td>float</td>
<td>1.0</td>
<td>Scaling factor for the standard deviation of the normal distribution. Default is 1.0.</td>
</tr>
<tr class="even">
<td>kwargs</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>mi.Tensor</strong></td>
<td></td>
<td><strong>A tensor initialized using Xavier Normal initialization.</strong></td>
</tr>
</tbody>
</table>
<p>It’s worth noting that there is also a Xavier initialization variant suitable for uniform distributions as opposed to normal distributions. The resultant weight matrix will comprise values sampled from a uniform distribution within the scope of <span class="math inline">\((-a, a)\)</span>, with <span class="math inline">\(a\)</span> equalling <span class="math inline">\(\sqrt{\frac{6}{n_{in}+n_{out}}}\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/11.xav-uniform.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Xavier initialization from a uniform distribution</figcaption>
</figure>
</div>
<hr>
<p><a href="https://github.com/m0saan/minima/blob/main/minima/init.py#L239" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="xavier_uniform" class="level3">
<h3 class="anchored" data-anchor-id="xavier_uniform">xavier_uniform</h3>
<blockquote class="blockquote">
<pre><code> xavier_uniform (fan_in, fan_out, gain=1.0, **kwargs)</code></pre>
</blockquote>
<p>Initializes a tensor using Xavier (Glorot) Uniform initialization.</p>
<p>This initializer is designed to keep the scale of the gradients roughly the same in all layers. It samples weights from a uniform distribution within the range <code>[-gain * sqrt(6 / (fan_in + fan_out)), gain * sqrt(6 / (fan_in + fan_out))]</code></p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fan_in</td>
<td>int</td>
<td></td>
<td>The number of input units in the weight tensor.</td>
</tr>
<tr class="even">
<td>fan_out</td>
<td>int</td>
<td></td>
<td>The number of output units in the weight tensor.</td>
</tr>
<tr class="odd">
<td>gain</td>
<td>float</td>
<td>1.0</td>
<td>Scaling factor for the range of the uniform distribution. Default is 1.0.</td>
</tr>
<tr class="even">
<td>kwargs</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>mi.Tensor</strong></td>
<td></td>
<td><strong>A tensor initialized using Xavier Uniform initialization.</strong></td>
</tr>
</tbody>
</table>
<p>Both normal and uniform distributions have demonstrated effectiveness in practical applications, and it is up to the network designer to select the preferred method. Xavier initialization is frequently utilized in practical scenarios to promote more stable training and circumvent issues that stem from unstable gradients, such as the vanishing and exploding gradient predicaments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize weights with Xavier/Glorot initialization</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> xavier_uniform(fan_in<span class="op">=</span><span class="dv">10</span>, fan_out<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>W</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>minima.Tensor(
[[-0.221499 -0.06155  -0.077118  0.56846  -0.418471]
 [-0.149945 -0.553442  0.581115 -0.460948 -0.420142]
 [-0.355427 -0.066154  0.355814  0.082557 -0.556673]
 [-0.497098 -0.087087 -0.051234 -0.238323 -0.290452]
 [-0.280464  0.334714  0.116377 -0.481387 -0.388613]
 [ 0.110984  0.625096 -0.228138 -0.500467  0.502594]
 [-0.400704  0.197745  0.166157 -0.479262  0.577242]
 [-0.196405 -0.577416 -0.605291 -0.294985 -0.606795]
 [ 0.321031 -0.098246  0.278399  0.047973  0.295106]
 [-0.385705  0.34554  -0.519177  0.389492  0.040751]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> xavier_normal(fan_in<span class="op">=</span><span class="dv">10</span>, fan_out<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>W</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>minima.Tensor(
[[-0.063341 -0.374345 -0.352547  0.789786 -0.782333]
 [ 0.195202 -0.227442  0.252176  0.225021  0.105454]
 [-0.174635 -0.043868  0.195862 -0.917395  0.502817]
 [ 0.177671  0.373282  0.601478  0.593381 -0.1945  ]
 [ 0.056075  0.224731 -0.458342 -0.133477 -0.138557]
 [ 0.393741  0.096873  0.514728  0.195166 -0.260037]
 [-0.161321 -0.056462  0.609632 -0.470343  0.118147]
 [-0.359394 -0.297816  0.383475  0.310443  0.510362]
 [-0.433323 -0.49009  -0.362796  0.263523 -0.023001]
 [-0.156537  0.312429 -0.113006 -0.195525  0.197912]])</code></pre>
</div>
</div>
<p>The original Xavier initialization was designed for use with the sigmoid activation function, which is symmetric around zero. If you’re using a different activation function, like ReLU, you might need a different initialization scheme, like He initialization, which is a modification of Xavier initialization designed for ReLU and other non-symmetric activation functions.</p>
</section>
<section id="he-initialization" class="level3">
<h3 class="anchored" data-anchor-id="he-initialization">He Initialization</h3>
<p>Kaiming Initialization, also known as He Initialization, is a method used in initializing the weights of Neural Networks. This initialization method is designed specifically for neural networks with Rectified Linear Unit (ReLU) activation functions. It was proposed by Kaiming He et al.&nbsp;in their 2015 paper “Delving Deep into Rectifiers: Surpassing Human-Level Performance on ImageNet Classification”.</p>
<p><strong>Principles of Kaiming Initialization:</strong></p>
<p>The basic idea of Kaiming Initialization is to keep the variance of the input and output of each layer of the neural network as consistent as possible during the forward and backward propagation. This is to solve the problem of gradient dispersion or explosion caused by the deepening of the neural network layer, which can help the model learn effectively.</p>
<p>Kaiming initialization initializes a weight matrix <span class="math inline">\(w\)</span> with random values sampled from a normal distribution with mean of <span class="math inline">\(0\)</span> and variance</p>
<p><span class="math display">\[\text{var}(w)=\frac{2}{n_{i}}\]</span></p>
<p>Here, <code>n_i</code> is the number of inputs to the neuron, <code>w</code> is the weight vector.</p>
<p>Just as with Xavier initialization, to force the weights distribution to take on this variance, the weights ar first randomly generated from a normal distribution with centered around 0 with a standard deviation of 1. Then, each weight is multiplied by</p>
<p><span class="math display">\[\sqrt{\frac{2}{n_{i}}}\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/12.kaiming-normal.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Kaiming initialization from a normal distributiont</figcaption>
</figure>
</div>
<p>where <code>n</code> is the number of inputs coming into a neuron (also known as the “fan-in”).</p>
<hr>
<p><a href="https://github.com/m0saan/minima/blob/main/minima/init.py#L272" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="kaiming_normal" class="level3">
<h3 class="anchored" data-anchor-id="kaiming_normal">kaiming_normal</h3>
<blockquote class="blockquote">
<pre><code> kaiming_normal (fan_in, fan_out, nonlinearity='relu', **kwargs)</code></pre>
</blockquote>
<p>Fills the input Tensor with values according to the method described in “Delving deep into rectifiers: Surpassing human-level performance on ImageNet classification” - He, K. et al.&nbsp;(2015), using a normal distribution. The resulting tensor will have values sampled from normal distribution with mean=0 and std=sqrt(2 / fan_in).</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fan_in</td>
<td>int</td>
<td></td>
<td>Number of input units in the weight tensor.</td>
</tr>
<tr class="even">
<td>fan_out</td>
<td>int</td>
<td></td>
<td>Number of output units in the weight tensor.</td>
</tr>
<tr class="odd">
<td>nonlinearity</td>
<td>str</td>
<td>relu</td>
<td>The non-linear function (<code>nn.functional</code> name), recommended to use only with ‘relu’ or ‘leaky_relu’. Default is ‘relu’.</td>
</tr>
<tr class="even">
<td>kwargs</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>mi.Tensor</strong></td>
<td></td>
<td><strong>A tensor of shape (fan_in, fan_out), filled with random numbers from the normal distribution according to the Kaiming initialization.</strong></td>
</tr>
</tbody>
</table>
<p>There is also a version of Kaiming initialization to use for uniform distributions rather than normal distributions. The resulting weight matrix will have values sampled from a uniform distribution within the range <span class="math inline">\((-a, a)\)</span>, where</p>
<p><span class="math display">\[a = \sqrt{\frac{6}{n_{i}}}\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/13.kaiming-uniform.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Kaiming initialization from a uniform distributiont</figcaption>
</figure>
</div>
<hr>
<p><a href="https://github.com/m0saan/minima/blob/main/minima/init.py#L304" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="kaiming_uniform" class="level3">
<h3 class="anchored" data-anchor-id="kaiming_uniform">kaiming_uniform</h3>
<blockquote class="blockquote">
<pre><code> kaiming_uniform (fan_in, fan_out, nonlinearity='relu', **kwargs)</code></pre>
</blockquote>
<p>Fills the input Tensor with values according to the method described in “Delving deep into rectifiers: Surpassing human-level performance on ImageNet classification” - He, K. et al.&nbsp;(2015), using a uniform distribution. The resulting tensor will have values sampled from uniform distribution in the range [-std, std] where std = sqrt(2 / fan_in).</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fan_in</td>
<td>int</td>
<td></td>
<td>Number of input units in the weight tensor.</td>
</tr>
<tr class="even">
<td>fan_out</td>
<td>int</td>
<td></td>
<td>Number of output units in the weight tensor.</td>
</tr>
<tr class="odd">
<td>nonlinearity</td>
<td>str</td>
<td>relu</td>
<td>The non-linear function (<code>nn.functional</code> name), recommended to use only with ‘relu’ or ‘leaky_relu’. Default is ‘relu’.</td>
</tr>
<tr class="even">
<td>kwargs</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>mi.Tensor</strong></td>
<td></td>
<td><strong>A tensor of shape (fan_in, fan_out), filled with random numbers from the uniform distribution according to the Kaiming initialization.</strong></td>
</tr>
</tbody>
</table>
<p><strong>Advantages of Kaiming Initialization:</strong></p>
<ol type="1">
<li>It helps to keep the variance of the gradients roughly the same across all layers. This ensures that all layers in the network learn at about the same speed, avoiding the saturation of activation functions, and it can also help speed up the convergence of the network.</li>
<li>It performs better with ReLU and its variants because it accounts for the fact that the variance of the output of a neuron with a ReLU activation function is half the variance of its input.</li>
</ol>
</section>
<section id="lsuv-initialization" class="level3">
<h3 class="anchored" data-anchor-id="lsuv-initialization">LSUV Initialization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Hook():</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, layer, fn): <span class="va">self</span>.hook <span class="op">=</span> layer.register_forward_hook(partial(fn, <span class="va">self</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># def remove(self): self.hook.remove()</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># def __del__(self): self.remove()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> append_stats(hook, mod, inp, outp):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">hasattr</span>(hook,<span class="st">'stats'</span>): hook.stats <span class="op">=</span> ([],[])</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    acts <span class="op">=</span> outp <span class="co"># </span><span class="al">TODO</span><span class="co">: move outp to cpu when USING ACCELERAOR!! :3</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    hook.stats[<span class="dv">0</span>].append(acts.numpy().mean())</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    hook.stats[<span class="dv">1</span>].append(acts.numpy().std())</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| export</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _lsuv_stats(hook, mod, inp, outp):</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    acts <span class="op">=</span> outp</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    hook.mean <span class="op">=</span> acts.numpy().mean()</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    hook.std <span class="op">=</span> acts.numpy().std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LSUV:</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model, batch) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> model</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.batch <span class="op">=</span> batch</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.params_layers <span class="op">=</span> [m <span class="cf">for</span> m <span class="kw">in</span> model <span class="cf">if</span> <span class="bu">hasattr</span>(m, <span class="st">'weight'</span>) <span class="kw">and</span> <span class="kw">not</span> <span class="bu">isinstance</span>(m, mi.nn.BatchNorm1d)]</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.act_fns <span class="op">=</span> [m <span class="cf">for</span> m <span class="kw">in</span> model <span class="cf">if</span> <span class="bu">isinstance</span>(m, mi.nn.ReLU)]</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Constants</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.TOLERANCE <span class="op">=</span> <span class="fl">1e-3</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> lsuv_init(<span class="va">self</span>):</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co">        Layer-wise Sequential Unit Variance Initialization (LSUV).</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co">        A method to help neural nets converge faster.</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co">        model : the model on which to perform LSUV initialization</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co">        param_module : the module with trainable parameters to which the Hook is to be registered</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="co">        activation_module : the activation module to be initialized (ReLU, Sigmoid, etc.)</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="co">        input_data : input data to be passed through the model</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> params_layer, acts_layer <span class="kw">in</span> <span class="bu">zip</span>(<span class="va">self</span>.params_layers, <span class="va">self</span>.act_fns):</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>            hook <span class="op">=</span> Hook(acts_layer, _lsuv_stats)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> <span class="va">self</span>.model(<span class="va">self</span>.batch) <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="kw">and</span> (<span class="bu">abs</span>(hook.std<span class="op">-</span><span class="dv">1</span>) <span class="op">&gt;</span> <span class="va">self</span>.TOLERANCE <span class="kw">or</span> <span class="bu">abs</span>(hook.mean) <span class="op">&gt;</span> <span class="va">self</span>.TOLERANCE):</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f'---&gt; before: </span><span class="sc">{</span>hook<span class="sc">.</span>mean<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>hook<span class="sc">.</span>std<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> params_layer.bias <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>: params_layer.bias <span class="op">-=</span>  mi.Tensor(hook.mean)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>                params_layer.weight.data <span class="op">/=</span> mi.Tensor(hook.std)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'-------------&gt; after: </span><span class="sc">{</span>hook<span class="sc">.</span>mean<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>hook<span class="sc">.</span>std<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        hook.remove()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> minima <span class="im">as</span> mi</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of samples</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of features (28x28 pixels for a grayscale image)</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>n_features <span class="op">=</span> <span class="dv">784</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of classes</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>n_classes <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random inputs from a standard normal distribution</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> mi.init.randn(n_samples, n_features)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random target classes</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> mi.Tensor(np.random.randint(<span class="dv">0</span>, n_classes, size<span class="op">=</span>n_samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the neural network architecture</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> mi.nn.Sequential(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    mi.nn.Linear(<span class="dv">784</span>, <span class="dv">128</span>),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    mi.nn.ReLU(),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    mi.nn.Linear(<span class="dv">128</span>, <span class="dv">10</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>lsuv <span class="op">=</span> LSUV(model, X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: 'Sequential' object is not iterable</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lsuv.lsuv_init()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="export" class="level2">
<h2 class="anchored" data-anchor-id="export">Export</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nbdev<span class="op">;</span> nbdev.nbdev_export()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>